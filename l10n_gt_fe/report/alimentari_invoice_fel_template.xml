<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <data>
        <template id="fel_layout">
            <t t-if="not o" t-set="o" t-value="doc" />

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id" />
                </t>
                <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
                    <t t-set="company" t-value="o.company_id.sudo()" />
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company" />
                </t>
            </t>

            <div class="header">
                <style>
                    .dte {
                        float: right;
                        border-color: #a01f23;
                        border: 1px;
                        border-radius: 5px;
                        padding: 5px;
                        width: 100%;
                        border-collapse: collapse;
                        border: #a01f23 1px solid;
                    }
            
                    thead {
                        background-color: #a01f23;
                        color: #fff;
                    }
                    .border-color{
                        border: #a01f23 1px solid;
                    }
                    .brd-top{
                        border-top: #a01f23 0px solid;
                    }
                    .dte th, .dte td {
                        padding: 5px 5px 5px 10px;
                    }
                    
                </style>
                <div class="container p-0" style="font-size: 12.5px;">
                    <div class="row mt-4">
                        <div class="col-6 float-left">
                            <table cellspacing="0">

                                <body>
                                    <tr>
                                        <td>
                                            <img src="/l10n_gt_fe/static/src/img/logo_alimentari.png" style="width:210px;" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span t-field="doc.company_id.name" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span t-field="doc.company_id.name" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span t-field="doc.company_id.street" />
                                            ,
                                            <span t-field="doc.company_id.street2" />
                                            <span t-field="doc.company_id.city" />
                                            ,
                                            <span t-field="doc.company_id.country_id.name" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            NIT:
                                            <span t-field="doc.company_id.vat" />
                                            Tel.:
                                            <span t-field="doc.company_id.vat" />
                                        </td>
                                    </tr>
                                </body>
                            </table>
                        </div>

                        <div class="col-6  float-right">
                            <div class="container dte-cont p-0">
                                <div class="row text-center">
                                    <div class="col-12">
                                        <span style="text-align: right;">DOCUMENTO TRIBUTARIO ELECTRÓNICO</span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <table class="dte">
                                            <thead>
                                                <tr>
                                                    <th colspan="2" class="dte-th text-center">
                                                        <t t-if="doc.move_type == 'out_refund'">
                                                            <span>NOTA DE CRÉDITO</span>
                                                        </t>
                                                        <t t-else="">
                                                            <span>FACTURA CAMBIARIA ELECTRÓNICA</span>
                                                        </t>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>SERIE:</td>
                                                    <td>
                                                        <span t-field="doc.fe_serie" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>NO.</td>
                                                    <td>
                                                        <span t-field="doc.fe_number" />
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>FECHA:</td>
                                                    <td>
                                                        <span t-field="doc.fe_certification_date" />
                                                    </td>
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>


            </div>

            <div class="article" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <t t-out="0" />
            </div>
        </template>

        <template id="invoice_fel_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="l10n_gt_fe.fel_layout">
                        <div t-attf-class="page">
                            <style>
                            .border-color{
                                border: #a01f23 1px solid;
                            }
                            .brd-top{
                                border-top: #fff 0px solid;
                            }
                            .tbl-detail{
                                width: 100%;
                                height: 100%;
                                border: #a01f23 1px solid;
                            }

                            .tbl-detail th{
                                padding: 8px 8px 8px 8px;
                                font-weight: lighter;
                            }

                            .tbl-detail td{
                                border-left: #a01f23 1px solid;
                                border-right: #a01f23 1px solid;
                            }
                            
                            .tbl-detail thead{
                                background-color: #a01f23;
                                color: #fff;
                            }

                            .page{
                                width: 100%;
                            }

                            .detail{
                                height: 100%;
                            }

                        </style>

                            <div class="container mt-2" style="font-size: 12.5px;">
                                <div class="row p-1 border-color">
                                    <div class="col-2">
                                        <span>Nombre: </span>
                                    </div>
                                    <div class="col-6">
                                        <span t-field="doc.partner_id.name" />
                                    </div>
                                    <div class="col-1">
                                        <span>NIT: </span>
                                    </div>
                                    <div class="col-3">
                                        <span t-field="doc.partner_id.vat" />
                                    </div>
                                </div>
                                <div class="row p-1 border-color brd-top">
                                    <div class="col-2">
                                        <span>Dirección: </span>
                                    </div>
                                    <div class="col-10">


                                        <t t-if="not doc.company_id.street and not doc.company_id.street2">
                                            <td>
                                                <span>CIUDAD</span>
                                            </td>
                                        </t>
                                        <t t-else="else">
                                            <td>
                                                <span t-field="doc.partner_id.street" />
                                                <t t-if="doc.partner_id.street2">
                                                    <span>, </span>
                                                    <span t-field="doc.partner_id.street2" />
                                                </t>
                                            </td>
                                        </t>
                                    </div>

                                </div>
                            </div>

                            <div class="container detail mt-4 p-0" style="font-size: 12.5px;">
                                <div class="row">
                                    <div class="col-12">
                                        <table class="tbl-detail" style="height: 100vh;">
                                            <thead class="text-center">
                                                <tr>
                                                    <th style="width:10%">Código</th>
                                                    <th style="width:45%">Descripción</th>
                                                    <th style="width:10%">Cantidad</th>
                                                    <th style="width:10%">Unidad</th>
                                                    <th style="width:10%">Precio</th>
                                                    <th style="width:15%">Importe</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <t t-foreach="doc.invoice_line_ids" t-as="line">
                                                    <tr>
                                                        <td class="text-center">
                                                            <span t-field="line.product_id.default_code" />
                                                        </td>
                                                        <td>
                                                            <span t-field="line.product_id.name" />
                                                        </td>
                                                        <td class="text-center">
                                                            <span t-field="line.quantity" />
                                                        </td>
                                                        <td class="text-center">
                                                            <span t-field="line.product_id.uom_id.name" />
                                                        </td>
                                                        <td class="text-right">
                                                            <span t-field="line.product_id.list_price" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' />
                                                        </td>
                                                        <td class="text-right">
                                                            <span t-field="line.price_total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}' />

                                                            <!-- <span t-esc="'{:,.2f}'.format(line.price_total)" /> -->
                                                        </td>
                                                    </tr>
                                                </t>
                                            </tbody>

                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <template id="invoice_fel_footer_invoice_template">
                            <div t-attf-class="footer">
                                <style>   
                                    /*frase*/
                                    .tbl-frase {
                                        width: 100%;
                                        /* border: #a01f23 1px solid; */
                                    }
                            
                                    .tbl-frase td {
                                        padding: 8px 8px 8px 8px;
                                        font-weight: lighter;
                                    }
                            
                                    .tbl-frase td {
                                        border-left: #a01f23 1px solid;
                                        border-right: #a01f23 1px solid;
                                    }
    
                                    /*letras*/
                                    .tbl-letras {
                                        width: 100%;
                                        /* border: #a01f23 1px solid; */
                                    }
                            
                                    .tbl-letras td {
                                        padding: 8px 8px 8px 8px;
                                        font-weight: lighter;
                                    }
                            
                                    .tbl-letras td {
                                        border: #a01f23 1px solid;
                                    }


                                    /*certificador*/
                                    .tbl-certificador {
                                        width: 100%;
                                        /* border: #a01f23 1px solid; */
                                    }

                                    .tbl-certificador td {
                                        padding: 0px 0px 0px 10px;
                                        font-weight: lighter;
                                    }

                                    .certificador{
                                        border-bottom: #a01f23 1px solid;
                                        border-left: #a01f23 1px solid;
                                        border-right: #a01f23 1px solid;
                                    }
                                </style>
                                <div class="container p-0" style="font-size: 12.5px;">
                                    <div class="row">
                                        <div class="col-12">
                                            <table class="tbl-frase text-center">
                                                <tbody>
                                                    <t t-foreach="doc.fe_phrase_ids" t-as="frase">
                                                        <tr>
                                                            <td style="width:10%"></td>
                                                            <td style="width:45%">
                                                                <span t-field="frase.name" />
                                                            </td>
                                                            <td style="width:10%"></td>
                                                            <td style="width:10%"></td>
                                                            <td style="width:10%"></td>
                                                            <td style="width:15%"></td>
                                                        </tr>
                                                    </t>
                                                </tbody>

                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <div class="container p-0" style="font-size: 12.5px;">
                                    <div class="row">
                                        <div class="col-12">
                                            <table class="tbl-letras text-center">
                                                <t t-set="tax_totals" t-value="json.loads(doc.tax_totals_json)" />
                                                <tbody>
                                                    <tr>
                                                        <td colspan="4" class="text-left" style="width:75%">
                                                            <span>TOTAL EN LETRAS: </span>
                                                            <span t-esc="str(doc.get_num2words(doc.amount_total)).upper()" />
                                                        </td>
                                                        <td style="width:10%">
                                                            <strong>TOTAL</strong>
                                                        </td>
                                                        <td class="text-right" style="width:15%">
                                                            <span t-esc="tax_totals['formatted_amount_total']" />
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>

                                        </div>
                                    </div>
                                </div>

                                <div class="container p-0 certificador" style="font-size: 12.5px;">
                                    <div class="row">
                                        <div class="col-12">
                                            <table class="tbl-certificador">
                                                <tbody class="pt-2">
                                                    <tr>
                                                        <td class="text-left" colspan="4" style="width:75%">
                                                            <span>Número de Autorización:  </span>
                                                            <span t-field="doc.fe_uuid" />
                                                        </td>
                                                        <td rowspan="3" style="width:10%">QR</td>
                                                        <td rowspan="3" style="width:15%">
                                                            <img src="/l10n_gt_fe/static/src/img/fel_icon.png" style="width:80%; height:auto;" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" style="width:75%">
                                                            <span>Fecha de Certificación:  </span>
                                                            <span t-field="doc.fe_certification_date" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" style="width:75%">
                                                            <span>CERTIFICADOR: INFILE, S.A.  </span>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td colspan="4" style="width:75%">
                                                            <span>NIT: 12521337   </span>
                                                        </td>
                                                    </tr>
                                                </tbody>

                                            </table>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </template>
                    </t>
                </t>
            </t>
        </template>

    </data>

</odoo>